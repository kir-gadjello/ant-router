# ==================================================================================
# Unified Model Configuration Protocol (UMCP) v1.0 - Default Configuration
# ==================================================================================
#
# This configuration file defines the server behavior, upstream provider settings,
# and model definitions. It supports inheritance, deep merging, and intelligent routing.
#
# USAGE:
#   This file is loaded by default from `./config.yaml` or `$HOME/.ant-router/config.yaml`.
#   You can override values using environment variables.
#
# ==================================================================================

# ----------------------------------------------------------------------------------
# Server Configuration
# ----------------------------------------------------------------------------------
server:
  host: "0.0.0.0"
  port: 3000

# ----------------------------------------------------------------------------------
# Logging Configuration
# ----------------------------------------------------------------------------------
log_enabled: true
# log_file: "./requests.jsonl"

# ----------------------------------------------------------------------------------
# Security Flags
# ----------------------------------------------------------------------------------
# If true, explicitly forbids any request where the wire model ID contains "anthropic".
no_ant: false

# ----------------------------------------------------------------------------------
# Default Upstream Configuration
# ----------------------------------------------------------------------------------
upstream:
  base_url: "https://openrouter.ai/api"
  api_key_env_var: "OPENROUTER_API_KEY"

# ----------------------------------------------------------------------------------
# Current Profile (Routing)
# ----------------------------------------------------------------------------------
# The active profile that defines how requests are routed to logical models.
current_profile: "stepfun"

# ----------------------------------------------------------------------------------
# Model Definitions (UMCP)
# ----------------------------------------------------------------------------------
# Define logical models with capabilities, context limits, and upstream parameters.
# Profiles map request patterns to these Keys.
models:

  # --- Base Templates ---
  _base_openrouter:
    provider: openrouter
    api_params:
      extra_body:
        stream_options:
          include_usage: true

  # --- Concrete Models ---

  # Stepfun Models
  "stepfun-flash":
    extends: _base_openrouter
    api_model_id: "stepfun/step-3.5-flash:free"
    aliases: ["step-3.5-flash"]

  # Gemini Models
  "gemini-pro-exp":
    extends: _base_openrouter
    api_model_id: "google/gemini-2.0-pro-exp-02-05:free"
    aliases: ["gemini-2.0-pro"]

  # Vision Models (for Profile Mapping)
  "gpt-4o":
    extends: _base_openrouter
    api_model_id: "openai/gpt-4o"
    capabilities:
      vision: true

  "o1":
    extends: _base_openrouter
    api_model_id: "openai/o1"
    capabilities:
      reasoning: true

# ----------------------------------------------------------------------------------
# Profiles
# ----------------------------------------------------------------------------------
# Profiles define mapping rules.
# - pattern: Regex/Glob to match input model ID.
# - target: Key in `models` map (Logical Model ID).
# - reasoning_target: Optional override for thinking requests.
# - ant_vision_model: Optional model for vision requests.
# - ant_vision_reasoning_model: Optional model for vision + thinking requests.

profiles:
  # Profile: Stepfun Flash (Free)
  stepfun:
    rules:
      - pattern: ".*"
        target: "stepfun-flash"
        reasoning_target: "stepfun-flash"
    ant_vision_model: "gpt-4o"

  # Profile: Maps everything to Google's Gemini 2.0 Pro (Free)
  gemini_free:
    rules:
      - pattern: ".*"
        target: "gemini-pro-exp"
    ant_vision_model: "gpt-4o"
